main: http_server
modules:
  - log
  - jwt

steps:
  - name: "Test PHS scalar"
    value: some_variable + 10
    endpoint: "/api/test"
    message: payload.user.name
    calculation: x * 2 + y
    boolean_value: true
    number_value: 42
    
  - use: log
    input:
      message: "User logged in: " + user.name
      level: if error { "ERROR" } else { "INFO" }
      
  - array_example:
      - simple_string
      - variable_name + 1
      - {name: "test", value: some_var}
      
  - object_example:
      name: user.first_name
      age: user.age + 1
      active: user.status == "active"
      tags: [tag1, tag2, variable_tag]
      
# Directives should remain as directives
!include config.yaml
!import shared/common.phlow
!phs let x = 10; x + 5

# Special keys should remain special
envs:
  - API_KEY
  - DATABASE_URL
  
setup:
  database_url: env.DATABASE_URL
  api_key: env.API_KEY || "default"
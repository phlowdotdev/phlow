modules:
  - module: log

steps:
  - assert: !phs main == 1
    then:
      - payload: !phs main + 1
      - log:
          message: !phs main + 1
    else:
      !include inner.phlow
  - payload: !phs payload + 10
  - payload: !phs payload + 1
  - log:
      level: error
      message: !phs {
        let val = payload * 10;
        let no = [1, 2, 3];
        let obj = #{target: 1};

        #{
            item: val,
            ...obj,
            name: [...no,4,5,6],
            it: #{a: 1, b: [2, ...no, ...obj]}
        }
      }

tests:
  - describe: Test
    main: 1
    assert_eq: 13
  - describe: Test
    main: 2
    assert_eq: 14

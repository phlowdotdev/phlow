name: fs
description: |
  Filesystem utilities for reading files/directories and writing files/directories.

  Actions:
  - `read`: Read a file content or list a directory (optionally recursive)
  - `write`: Create/update a file or create a directory

version: 0.1.0
author: Phlow Contributors
repository: https://github.com/phlowdotdev/phlow
license: MIT
type: step

tags:
  - fs
  - filesystem
  - io
  - read
  - write

with:
  type: object
  required: false
  properties: {}

input:
  type: object
  required: true
  properties:
    action:
      type: string
      description: Module action to perform.
      enum: ["read", "write"]
      required: true

    # Common
    path:
      type: string
      description: Target file or directory path.
      required: true

    # read
    recursive:
      type: boolean
      description: When reading a directory, list entries recursively (default false).
      required: false

    # write (file): provide content
    content:
      type: any
      description: When provided, creates/overwrites a file with this content.
      required: false
    force:
      type: boolean
      description: Overwrite file if it exists (default false).
      required: false
    # write (directory): omit content, path is treated as directory to create

output:
  type: object
  required: true
  properties:
    success:
      type: boolean
      required: true
    error:
      type: string
      required: false
    data:
      type: object
      description: Action specific payload.
      required: false
      properties:
        kind:
          type: string
          description: one of [file, dir]
        path:
          type: string
        # file read
        encoding:
          type: string
          description: utf8 or base64 when content not valid utf8
        content:
          type: string
        content_base64:
          type: string
        size:
          type: number
        modified:
          type: number
          description: Last modified as UNIX timestamp (seconds)
        # dir read
        items:
          type: array
          description: List of items for directory reads
